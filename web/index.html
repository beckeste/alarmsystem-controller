<!DOCTYPE html>
<html>
<head>
    <title>Alarm System</title>
    <!-- Bulma CSS von CDN einbinden -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2.6.14"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        // Ermittlung der Host-IP-Adresse und des API-Ports zur Laufzeit
        const hostIpAddress = window.location.hostname;
        const apiPort = 8081;
    </script>
</head>
<body>
    <section class="section">
        <div class="container" id="app">
            <h1 class="title">Alarm System</h1>
            <div class="buttons">
                <button class="button is-primary" @click="armSystem">Arm System</button>
                <button class="button is-warning" @click="disarmSystem">Disarm System</button>
                <button class="button is-danger" @click="triggerAlarm('low')">Trigger Low Alarm</button>
                <button class="button is-danger" @click="triggerAlarm('medium')">Trigger Medium Alarm</button>
                <button class="button is-danger" @click="triggerAlarm('high')">Trigger High Alarm</button>
            </div>
            <p class="subtitle">System Status: {{ systemStatus }}</p>
            <p class="subtitle">Alarm Level: {{ alarmLevel }}</p>

            <h2 class="title is-4">Sensors</h2>
            <ul>
                <li v-for="sensor in sensors" :key="sensor.mac_address">
                    <span class="tag is-info">MAC: {{ sensor.mac_address }}</span> - 
                    <span class="tag is-light">Last Updated: {{ sensor.last_updated }}</span> - 
                    <span class="tag is-dark">IP: {{ sensor.ip_address }}</span>
                    <span class="tag is-primary">Name: {{ sensor.name }}</span>
                    <button class="button is-small is-danger is-outlined" @click="deleteSensor(sensor.mac_address)">Delete</button>
                    <button class="button is-small is-info is-outlined" @click="editSensor(sensor)" v-if="!sensor.editing">Edit</button>
                    <div v-if="!sensor.editing">
                        <p>Buzzer: {{ sensor.capabilities.buzzer ? 'Yes' : 'No' }}</p>
                        <p>Door Sensor: {{ sensor.capabilities.door_sensor ? 'Yes' : 'No' }}</p>
                        <p>Shutter Sensor: {{ sensor.capabilities.shutter_sensor ? 'Yes' : 'No' }}</p>
                        <p>Motion Sensor: {{ sensor.capabilities.motion_sensor ? 'Yes' : 'No' }}</p>
                        <p>Siren: {{ sensor.capabilities.siren ? 'Yes' : 'No' }}</p>
                        <p>Armed: {{ sensor.states.armed ? 'Yes' : 'No' }}</p>
                        <p>Door Open: {{ sensor.states.door_open ? 'Yes' : 'No' }}</p>
                        <p>Shutter Open: {{ sensor.states.shutter_open ? 'Yes' : 'No' }}</p>
                        <p>Motion Detected: {{ sensor.states.motion_detected ? 'Yes' : 'No' }}</p>
                        <p>Siren On: {{ sensor.states.siren_on ? 'Yes' : 'No' }}</p>
                        <p>Buzzer On: {{ sensor.states.buzzer_on ? 'Yes' : 'No' }}</p>
                    </div>
                    <div v-else>
                        <label class="label">Name</label>
                        <input class="input" v-model="sensor.name">
                        <label class="label">IP Address</label>
                        <input class="input" v-model="sensor.ip_address">
                        <label>
                            <input type="checkbox" v-model="sensor.capabilities.buzzer"> Buzzer
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.capabilities.door_sensor"> Door Sensor
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.capabilities.shutter_sensor"> Shutter Sensor
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.capabilities.motion_sensor"> Motion Sensor
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.capabilities.siren"> Siren
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.armed"> Armed
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.door_open"> Door Open
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.shutter_open"> Shutter Open
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.motion_detected"> Motion Detected
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.siren_on"> Siren On
                        </label>
                        <label>
                            <input type="checkbox" v-model="sensor.states.buzzer_on"> Buzzer On
                        </label>
                        <button class="button is-small is-success" @click="updateSensor(sensor)">Save</button>
                        <button class="button is-small" @click="cancelEdit(sensor)">Cancel</button>
                    </div>
                </li>
            </ul>
        </div>
    </section>

    <script src="app.js"></script>
</body>
</html>